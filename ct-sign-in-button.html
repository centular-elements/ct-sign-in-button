<link rel="import" href="../polymer/polymer.html">

<link rel="import" href="../iron-icon/iron-icon.html">
<link rel="import" href="../iron-icons/iron-icons.html">
<link rel="import" href="../paper-button/paper-button.html">
<link rel="import" href="../paper-icon-button/paper-icon-button.html">
<link rel="import" href="../app-route/app-route.html">
<link rel="import" href="../app-route/app-location.html">
<link rel="import" href="../ct-core-utils/ct-core.html">
<!--<link rel="import" href="../ct-user-api/ct-user-api.html">-->

<!--
`<ct-sign-in-button>` is used to authenticate with an API.
@demo
-->
<dom-module id="ct-sign-in-button">

  <template>
    <style>
      :host {
        display: block;
      }
      paper-button > iron-icon {
        margin-right: 0.4em;
      }
    </style>

    <paper-button on-tap="signIn">Sign in</paper-button>

    <!--<template is="dom-if" if="{{ signedIn }}">
      <paper-icon-button on-tap="signOut" icon="power-settings-new"></paper-icon-button>
    </template>-->

<!--    <app-location route="{{ route }}"></app-location>
    <app-route route="[[ route ]]" pattern="/oauth" tail="{{ routeData }}"></app-route>-->



    <!--<ct-user-api id="usersAPI"></ct-user-api>-->

  </template>

  <script>
    (function () {
      Polymer({
        is: 'ct-sign-in-button',

        /**
         * Fired when signed in.
         * @param {Object} detail The user object.
         * @event ct-sign-in
         */

        /**
         * Fired when there is an error during the signin flow.
         * @param {Object} detail The error object.
         * @event ct-sign-in-error
         */

        properties: {
          /**
           * Your client id obtained from the developer portal
           */
          clientId: String,
          /**
           * Token redirect uri where you receive oauth tokens for this application
           */
          tokenRedirectUri: String,
          /**
           * Authentication server host url
           */
          authHostUrl: String
        },

        /**
         * Sign in user. Redirects the user to authorization server for signing in.
         */
        _signIn: function() {
          window.location = [
            this.authHostUrl, '/oauth/authorise?response_type=token&client_id=', this.clientId,
            '&redirect_uri=', this.tokenRedirectUri, '&state=0'
          ].join('');
        }

        /**
         * Sign out the user
         */
        /*_signOut: function() {
          this._setToken(null);
          this.fire('ct-sign-out');
        },*/
      });
    })();
  </script>

</dom-module>
